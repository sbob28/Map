<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Bird Migration — Proportional Symbol Map</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 6px; }
    #vis { width: 100%; max-width: 1000px; margin: auto; }
    h1 { text-align: center; font-size: 18px; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>
<body>
  <h1>Migration start locations — size = observations, color = species</h1>
  <div id="vis"></div>

  <script>
  const spec = {
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "width": 1000,
    "height": 600,
    "projection": {"type": "equirectangular"},
    "layer": [
      {
        "data": {
          "url": "https://raw.githubusercontent.com/vega/vega-datasets/master/data/world-110m.json",
          "format": {"type": "topojson", "feature": "countries"}
        },
        "mark": {"type": "geoshape", "fill": "#f0f0f0", "stroke": "#bdbdbd"},
        "encoding": {}
      },
      {
        "data": {"url": "bird_migration_start_agg.csv"},
        "mark": {"type":"circle", "opacity":0.7, "stroke":"#222", "strokeWidth":0.3},
        "encoding": {
          "longitude": {"field": "Longitude", "type": "quantitative"},
          "latitude":  {"field": "Latitude",  "type": "quantitative"},
          "size": {
            "field": "Observation_Counts",
            "type": "quantitative",
            "title": "Observations",
            "scale": {"range": [10, 2000]}
          },
          "color": {
            "field": "Species",
            "type": "nominal",
            "legend": {"title": "Species"}
          },
          "tooltip": [
            {"field":"Species","type":"nominal"},
            {"field":"Observation_Counts","type":"quantitative"},
            {"field":"Sightings","type":"quantitative"},
            {"field":"Latitude","type":"quantitative"},
            {"field":"Longitude","type":"quantitative"}
          ]
        }
      }
    ]
  };

  vegaEmbed("#vis", spec, {actions:false});
  </script>
</body>
</html>
